# Delivery Dashboard - Constituci√≥n Global

**Framework:** Ralph-Compounding / Agentic Engineering  
**L√≠mite:** 200 l√≠neas m√°ximo (reglas pesadas en `/reference/`)

---

## üéØ Tech Stack

- **Frontend:** React 18.2 + Vite 5.1
- **UI:** TailwindCSS + Lucide React Icons
- **Charts:** Recharts 2.12
- **Backend:** Supabase (PostgreSQL + Auth + Edge Functions)
- **Sync:** Node.js (jira-supabase-sync)
- **Testing:** Vitest 4.0 + React Testing Library
- **Deployment:** GitHub Pages

---

## üìö Referencias On-Demand

**Cargar solo cuando sea relevante:**

- `/reference/api_guidelines.md` - Patrones de API y Supabase
- `/reference/ui_components.md` - Componentes React y patrones UI
- `/reference/database_schema.md` - Esquema Supabase y funciones RPC
- `/reference/deployment.md` - GitHub Pages y Edge Functions
- `/reference/configuration.md` - Variables de entorno y setup
- `/reference/troubleshooting.md` - Errores comunes y soluciones
- `/reference/metrics_calculations.md` - F√≥rmulas de KPIs
- `/reference/jira_integration.md` - Sync process y Jira API

---

## üèóÔ∏è Arquitectura

- **Componentes:** `src/components/` - React components
- **Servicios:** `src/services/` - Business logic
- **Utils:** `src/utils/` - Helpers y APIs
- **Sync:** `jira-supabase-sync/` - Servicio de sincronizaci√≥n Jira‚ÜíSupabase

---

## ‚úÖ Est√°ndares Globales

### Logging
- Usar `console.log` con prefijos: `[MODULE_NAME] Mensaje`
- En desarrollo: logging detallado
- En producci√≥n: solo errores cr√≠ticos

### Testing
- M√≠nimo 5 tests por feature nueva
- M√≠nimo 2 tests por bug fix
- Tests corren autom√°ticamente antes de commit (Husky)

### Imports
- Usar alias `@/` para imports absolutos: `@/components/Login`
- No usar imports relativos profundos: `../../../components`

### Iconos (Lucide React)
- **OBLIGATORIO:** Verificar que el icono existe en https://lucide.dev/icons/ antes de importar
- **NUNCA** asumir que un icono existe sin verificar
- Si no existe, buscar alternativa similar en la documentaci√≥n
- Iconos comunes v√°lidos: `Calendar`, `Clock`, `AlertCircle`, `TrendingUp`, `BarChart3`, `Activity`, `Truck`, `Shield`, `Heart`, `SquareChartGantt`
- Ver `src/components/agents.md` para lista completa y proceso de verificaci√≥n

### Verificaci√≥n de Tipos de Retorno
- **OBLIGATORIO:** Verificar el tipo de retorno de funciones utilitarias antes de usar m√©todos espec√≠ficos de tipo
- Revisar c√≥mo otros componentes usan la misma funci√≥n utilitaria
- Usar optional chaining (`?.`) para acceder a propiedades de objetos que pueden ser null/undefined
- **NUNCA** asumir que una funci√≥n retorna un tipo primitivo sin verificar

### Queries Supabase
- **OBLIGATORIO:** Usar `.maybeSingle()` cuando el resultado puede no existir (no `.single()`)
- **OBLIGATORIO:** Manejar errores de queries opcionales sin fallar la aplicaci√≥n
- Usar `.ilike()` para b√∫squedas de texto case-insensitive (no `.eq()` para texto)
- Usar `.or()` con m√∫ltiples condiciones cuando hay variaciones posibles
- Incluir manejo de errores con logging apropiado (`console.warn` para errores no cr√≠ticos)
- Validar datos antes de usar (usar optional chaining `?.`)
- **OBLIGATORIO:** Verificar qu√© columnas existen en una tabla antes de hacer SELECT
- **OBLIGATORIO:** Usar funciones RPC para datos calculados (no leer directamente de tabla si no existe)
- Manejar casos donde funciones RPC pueden no existir (try-catch con defaults)
- Ver `src/services/agents.md` para patrones completos y diferencias `.single()` vs `.maybeSingle()`

### Git
- Commits: `feat:`, `fix:`, `docs:`, `refactor:`
- Branch: `V1.08` (versionado)
- Pre-push: tests autom√°ticos

---

## üîÑ Workflows

### PRD-First Development
- Siempre crear PRD en `/specs/prd.md` antes de codificar
- Ver `/specs/stories.json` para user stories atomizadas

### Context Reset
- Planificar en una conversaci√≥n
- **RESET** (limpiar chat)
- Ejecutar en conversaci√≥n nueva

### System Evolution
- Cada bug ‚Üí actualizar `/src/**/agents.md` o `/reference/`
- Nunca solo "fix" - siempre mejorar el sistema

---

## üìñ Ver Tambi√©n

- `/specs/prd.md` - PRD principal del proyecto
- `AGENTS.md` - Constituci√≥n expandida y referencias
- `.cursor/rules/` - Reglas espec√≠ficas (testing, docs, best-practices)
