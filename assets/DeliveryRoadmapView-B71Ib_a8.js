import{j as e,r as x,U as p,a as A,C as y,A as C,P as I}from"./index-zzFyhS3F.js";import{K as v}from"./KPICard-QHlU6-cb.js";import{C as k,G as w}from"./GanttChart-C4OsGmSI.js";import{R as f,B as q,X as M,Y as O,T,a as z,C as h}from"./BarChart-BMm4yCV-.js";import{P as N,a as b}from"./PieChart-CtblTHAS.js";const F=({data:s})=>{const n=s.reduce((l,i)=>{const r=l.find(u=>u.name===i.squad);return r?r.value+=i.allocation:l.push({name:i.squad,value:i.allocation}),l},[]),a=["#60a5fa","#a78bfa","#34d399"];return e.jsx("div",{className:"h-[300px] w-full",children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(q,{data:n,layout:"vertical",margin:{top:5,right:30,left:40,bottom:5},children:[e.jsx(M,{type:"number",hide:!0}),e.jsx(O,{dataKey:"name",type:"category",width:100,tick:{fill:"#94a3b8",fontSize:12},axisLine:!1,tickLine:!1}),e.jsx(T,{contentStyle:{backgroundColor:"#1e293b",borderColor:"#334155",color:"#f8fafc"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(z,{dataKey:"value",radius:[0,4,4,0],barSize:32,children:n.map((l,i)=>e.jsx(h,{fill:a[i%a.length]},`cell-${i}`))})]})})})},E=({devData:s})=>{const n=x.useMemo(()=>{if(!s)return[];const a={};return s.forEach(l=>{l.dev!=="None"&&(a[l.dev]||(a[l.dev]={name:l.dev,total:0,tasks:[]}),a[l.dev].total+=l.percentage,a[l.dev].tasks.push({initiative:l.initiative,pct:l.percentage,squad:l.squad}))}),Object.values(a).sort((l,i)=>i.total-l.total)},[s]);return e.jsxs("div",{className:"glass rounded-2xl p-6 mt-8",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-6 text-white flex items-center gap-2",children:[e.jsx(p,{className:"text-cyan-400 w-5 h-5"})," Developer Workload & Allocation"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map((a,l)=>e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-white/5 hover:border-white/10 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-slate-700 to-slate-800 flex items-center justify-center text-slate-300 font-medium border border-white/5",children:a.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-200",children:a.name}),e.jsxs("div",{className:`text-xs font-medium ${a.total>100?"text-rose-400":a.total>=80?"text-cyan-400":"text-sky-400"}`,children:[a.total,"% Allocation"]})]})]}),a.total>100&&e.jsx("div",{className:"text-rose-400",title:"Overallocated",children:e.jsx(A,{size:16})})]}),e.jsx("div",{className:"space-y-2",children:a.tasks.map((i,r)=>e.jsxs("div",{className:"text-xs",children:[e.jsxs("div",{className:"flex justify-between text-slate-400 mb-1",children:[e.jsx("span",{className:"truncate pr-2",title:i.initiative,children:i.initiative}),e.jsxs("span",{className:"shrink-0",children:[i.pct,"%"]})]}),e.jsx("div",{className:"h-1 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${i.squad==="Core Infrastructure"?"bg-cyan-500":i.squad==="Integration"?"bg-sky-500":"bg-teal-500"}`,style:{width:`${i.pct}%`}})})]},r))})]},l))})]})},K=({value:s})=>{const n=[{name:"Score",value:Math.min(s,2)},{name:"Remaining",value:2-Math.min(s,2)}];return e.jsxs("div",{className:"relative h-[220px] flex flex-col items-center justify-center",children:[e.jsx(f,{width:"100%",height:"100%",children:e.jsx(N,{children:e.jsxs(b,{dataKey:"value",startAngle:180,endAngle:0,data:n,cx:"50%",cy:"50%",innerRadius:90,outerRadius:130,stroke:"none",children:[e.jsx(h,{fill:s>=.9?"#00D9FF":"#f43f5e"}),e.jsx(h,{fill:"#1e293b"})]})})}),e.jsxs("div",{className:"absolute bottom-8 text-center",children:[e.jsx("div",{className:"text-xs text-slate-400",children:"SPI"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:s})]})]})},L=({value:s})=>{const n=[{name:"Progress",value:s},{name:"Remaining",value:100-s}],a=l=>l>=90?"#00D9FF":l>=50?"#0EA5E9":l>0?"#f59e0b":"#64748b";return e.jsxs("div",{className:"relative h-[250px] flex items-center justify-center",children:[e.jsx(f,{width:"100%",height:"100%",children:e.jsx(N,{children:e.jsxs(b,{data:n,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,startAngle:90,endAngle:-270,dataKey:"value",stroke:"none",children:[e.jsx(h,{fill:a(s)}),e.jsx(h,{fill:"#1e293b"})]})})}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsxs("span",{className:"text-4xl font-bold text-white",children:[s,"%"]}),e.jsx("span",{className:"text-sm text-slate-400",children:"Complete"})]})]})},D=({allocation:s,squad:n})=>{const a=[{name:"Allocation",value:s},{name:"Remaining",value:Math.max(0,5-s)}];return e.jsxs("div",{className:"relative h-[200px]",children:[e.jsx(f,{width:"100%",height:"100%",children:e.jsx(N,{children:e.jsxs(b,{data:a,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,dataKey:"value",stroke:"none",children:[e.jsx(h,{fill:"#00D9FF"}),e.jsx(h,{fill:"#1e293b"})]})})}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[e.jsx("div",{className:"text-xs text-slate-400",children:"Team Allocation"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:s.toFixed(1)}),e.jsx("div",{className:"text-[10px] text-cyan-400 mt-1",children:n})]})]})},G=({initiative:s,devData:n})=>{const a=n.filter(l=>l.initiative===s);return a.length===0?e.jsx("div",{className:"text-slate-500 text-sm text-center py-4",children:"No team data available"}):e.jsx("div",{className:"space-y-3",children:a.map((l,i)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-slate-400",children:e.jsx(p,{size:16})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-slate-200",children:l.dev}),e.jsxs("span",{className:"text-slate-400",children:[l.percentage,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-cyan-500 rounded-full",style:{width:`${l.percentage}%`}})})]})]},i))})},$=({item:s,devData:n})=>{if(!s)return null;const l=n.filter(r=>r.initiative===s.initiative).reduce((r,u)=>r+u.percentage,0)/100,i=l>0?l:s.allocation;return e.jsxs("div",{className:"space-y-6 animate-shimmer",style:{animation:"fadeIn 0.5s ease-out"},children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"glass rounded-2xl p-6 flex flex-col items-center",children:[e.jsx("h3",{className:"text-slate-400 text-sm font-medium mb-4 w-full text-left",children:"SPI"}),e.jsx(K,{value:s.spi})]}),e.jsxs("div",{className:"glass rounded-2xl p-6 flex flex-col items-center",children:[e.jsx("h3",{className:"text-slate-400 text-sm font-medium mb-4 w-full text-left",children:"Allocation"}),e.jsx(D,{allocation:i,squad:s.squad})]}),e.jsxs("div",{className:"glass rounded-2xl p-6 flex flex-col items-center justify-center bg-slate-800/50",children:[e.jsx("h3",{className:"text-slate-400 text-sm font-medium mb-2 w-full text-center",children:"Progress"}),e.jsx(L,{value:s.status})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 glass rounded-2xl p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-slate-900/50 rounded-xl border border-white/5",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider font-semibold",children:"Initiative"}),e.jsx("div",{className:"text-lg font-medium text-white mt-1",children:s.initiative})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider font-semibold",children:"Start"}),e.jsx("div",{className:"text-lg font-medium text-white mt-1",children:s.start})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider font-semibold",children:"Delivery"}),e.jsx("div",{className:"text-lg font-medium text-white mt-1",children:s.delivery})]})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-24 shrink-0 text-sm font-semibold text-slate-400",children:"Scope"}),e.jsx("div",{className:"text-sm text-slate-200 leading-relaxed",children:s.scope})]}),e.jsx("div",{className:"h-px bg-white/5"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-24 shrink-0 text-sm font-semibold text-slate-400",children:"Comments"}),e.jsx("div",{className:"text-sm text-slate-200 leading-relaxed",children:s.comments})]})]})]}),e.jsxs("div",{className:"glass rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-slate-400 text-sm font-medium mb-4 flex items-center gap-2",children:[e.jsx(p,{size:16})," Team"]}),e.jsx(G,{initiative:s.initiative,devData:n})]})]}),e.jsxs("div",{className:"glass rounded-2xl p-6",children:[e.jsx("h3",{className:"text-slate-400 text-sm font-medium mb-4",children:"Roadmap"}),e.jsx(w,{data:[s]})]})]})},Y=({projectData:s,devAllocationData:n})=>{console.log("[ROADMAP] Componente renderizado:",{projectDataLength:(s==null?void 0:s.length)||0,hasProjectData:!!s,sample:s==null?void 0:s.slice(0,2)});const[a,l]=x.useState("All"),[i,r]=x.useState("All"),u=x.useMemo(()=>["All",...new Set(s.map(t=>t.squad))],[s]),R=x.useMemo(()=>{let t=s;return a!=="All"&&(t=t.filter(d=>d.squad===a)),["All",...new Set(t.map(d=>d.initiative))]},[s,a]),c=x.useMemo(()=>{let t=s;return a!=="All"&&(t=t.filter(d=>d.squad===a)),i!=="All"&&(t=t.filter(d=>d.initiative===i)),t},[s,a,i]),g=x.useMemo(()=>{if(i!=="All"){const t=s.find(d=>d.initiative===i);return console.log("[ROADMAP] selectedItem encontrado:",{selectedInitiative:i,found:!!t,item:t}),t}return console.log("[ROADMAP] selectedItem es null (mostrando Gantt)"),null},[s,i]),m=x.useMemo(()=>{const t=c.length,d=t?(c.reduce((o,j)=>o+j.spi,0)/t).toFixed(2):0,P=t?Math.round(c.reduce((o,j)=>o+j.status,0)/t):0,S=c.filter(o=>o.spi<.9||o.status<20).map(o=>o.initiative);return{total:t,avgSPI:d,avgProgress:P,atRisk:S}},[c]);return e.jsxs("div",{className:"space-y-8 animate-shimmer",style:{animation:"fadeIn 0.5s ease-out"},children:[e.jsxs("div",{className:"flex gap-4 mb-8",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("select",{className:"appearance-none bg-slate-800/50 border border-white/10 rounded-xl px-4 py-2 pr-10 text-slate-300 focus:outline-none focus:border-cyan-500/50 transition-colors cursor-pointer min-w-[150px]",value:a,onChange:t=>{l(t.target.value),r("All")},children:u.map(t=>e.jsxs("option",{value:t,children:[t," Squad"]},t))}),e.jsx(y,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none group-hover:text-cyan-400 transition-colors",size:16})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("select",{className:"appearance-none bg-slate-800/50 border border-white/10 rounded-xl px-4 py-2 pr-10 text-slate-300 focus:outline-none focus:border-cyan-500/50 transition-colors cursor-pointer min-w-[200px]",value:i,onChange:t=>r(t.target.value),children:R.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx(y,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none group-hover:text-cyan-400 transition-colors",size:16})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(v,{title:"Active Initiatives",value:m.total,label:"Projects in flight",trend:"positive",color:"blue",icon:C}),e.jsx(v,{title:"avg. SPI!",value:m.avgSPI,label:"Schedule Performance",trend:m.avgSPI>=.9?"positive":"negative",color:"purple",icon:k,explanation:"SPI > 1.0 means ahead of schedule."}),e.jsx(v,{title:"Avg. Completion",value:`${m.avgProgress}%`,label:"Overall Progress",trend:"positive",color:"emerald",icon:I}),e.jsx(v,{title:"At Risk",value:m.atRisk.length,label:"Requires Attention",trend:m.atRisk.length===0?"positive":"negative",color:"rose",icon:A,tooltip:m.atRisk})]}),console.log("[ROADMAP] Renderizando contenido:",{hasSelectedItem:!!g,selectedInitiative:i,filteredDataLength:c.length}),g?e.jsx($,{item:g,devData:n}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass rounded-2xl p-6",children:[e.jsx("h3",{className:"text-slate-400 text-sm font-medium mb-6",children:"Timeline Overview (Roadmap)"}),(console.log("ðŸ”µ [ROADMAP] ====== RENDERIZANDO GANTT ======"),console.log("ðŸ”µ [ROADMAP] filteredData.length:",c.length),console.log("ðŸ”µ [ROADMAP] Primeros 3 items:",c.slice(0,3).map(t=>({initiative:t.initiative,start:t.start,delivery:t.delivery,startType:typeof t.start,deliveryType:typeof t.delivery}))),null),e.jsx(w,{data:c})]}),e.jsxs("div",{className:"glass rounded-2xl p-6",children:[e.jsx("h3",{className:"text-slate-400 text-sm font-medium mb-6",children:"Resource Distribution"}),e.jsx(F,{data:c})]})]}),e.jsx(E,{devData:n})]})};export{Y as default};
